<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard InfoVis - Insider Threat</title>
    <link rel="stylesheet" href="css/style.css">
    <!-- carico D3.js da CDN -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
    <header>
        <h1>Dashboard Insider Threat Detection</h1>
        <p class="subtitle">Progetto InfoVis - Dataset CERT r4.2 (300 utenti)</p>
    </header>

    <main class="dashboard">
        <!-- pannello con i filtri -->
        <aside class="controls-panel">
            <h2>Filtri</h2>
            
            <!-- filtro cluster -->
            <div class="control-group">
                <label for="cluster-filter">Cluster:</label>
                <select id="cluster-filter" multiple>
                    <option value="all" selected>Tutti</option>
                    <!-- le altre opzioni vengono aggiunte da JS -->
                </select>
            </div>

            <!-- filtro tipo utente -->
            <div class="control-group">
                <label for="insider-filter">Tipo Utente:</label>
                <select id="insider-filter">
                    <option value="all" selected>Tutti</option>
                    <option value="1">Solo Insider</option>
                    <option value="0">Solo Normali</option>
                </select>
            </div>

            <!-- slider per score -->
            <div class="control-group">
                <label for="score-range">Anomaly Score:</label>
                <input type="range" id="score-min" min="0" max="100" value="0" step="any">
                <input type="range" id="score-max" min="0" max="100" value="100" step="any">
                <span id="score-display">0 - 100</span>
            </div>

            <button id="reset-filters" class="btn">Reset</button>
        </aside>

        <!-- griglia con le visualizzazioni -->
        <div class="viz-container">

            <!-- KPI CARDS - statistiche riassuntive -->
            <section class="viz-card full-width" id="kpi-section">
                <h2>Statistiche Generali</h2>
                <div id="schede-kpi" class="kpi-row"></div>
            </section>

            <!-- UNIVARIATE -->
            <section class="viz-card full-width">
                <h2>Distribuzione Anomaly Score</h2>
                <p class="description">Ogni barra raggruppa utenti con score simile. La maggior parte ha score basso (comportamento normale); la coda a destra con score alto indica i potenziali anomali. Gli insider non sono necessariamente nella coda più alta — il pattern comportamentale conta più dello score grezzo.</p>
                <div id="istogramma" class="chart"></div>
            </section>

            <!-- BIVARIATE -->
            <section class="viz-card full-width">
                <h2>Rank vs Anomaly Score (valori medi su 8 settimane)</h2>
                <p class="description">Ogni punto è un utente unico — i valori sono la media delle 8 settimane. <span style="color:#e74c3c;font-weight:bold;">Rosso = insider confermato</span>, <span style="color:#27ae60;font-weight:bold;">verde = normale</span>. Rank 1 = utente più anomalo secondo il modello. Nota: alcuni insider si trovano a rank medio-alto, a conferma che score e rank da soli non bastano a identificarli.</p>
                <div id="scatter-rank-score" class="chart"></div>
            </section>

            <!-- TRIVARIATE -->
            <section class="viz-card full-width">
                <h2>Attività After-Hour vs Score (valori medi su 8 settimane)</h2>
                <p class="description">Ogni punto è un utente unico (media 8 settimane). <strong>Posizione X</strong> = attività fuori orario, <strong>Y</strong> = anomaly score, <strong>colore</strong> = cluster di appartenenza, <strong>dimensione</strong> = attività totali. Un cerchio grande in alto a destra = molto attivo, fuori orario, score alto — ma non necessariamente insider. Il cluster C1 (arancio) domina l'asse after-hour pur non contenendo insider.</p>
                <div id="scatter-multivariato" class="chart"></div>
            </section>

            <!-- TEMPORAL -->
            <section class="viz-card full-width">
                <h2>Evoluzione Score Medio per Cluster (settimane 1–8)</h2>
                <p class="description">Ogni linea è un cluster — mostra come cambia lo score medio nelle 8 settimane. <span style="color:#e74c3c;font-weight:bold;">C4 (insider)</span> mantiene uno score relativamente stabile ma non è necessariamente il più alto in ogni settimana. Se una linea sale bruscamente in una settimana specifica, indica un evento anomalo concentrato in quel periodo.</p>
                <div id="grafico-temporale" class="chart"></div>
            </section>

            <!-- MULTIVARIATE -->
            <section class="viz-card full-width">
                <h2>Coordinate Parallele — 6 dimensioni simultanee</h2>
                <p class="description">Ogni linea è un utente (campione di 200). Ogni asse verticale è una feature diversa. Una linea che attraversa valori alti su più assi indica un utente anomalo su più dimensioni contemporaneamente — qualcosa impossibile da vedere in uno scatter 2D. Colore = cluster. Hover su una linea per isolarla.</p>
                <div id="coordinate-parallele" class="chart"></div>
            </section>

            <section class="viz-card">
                <h2>Profilo Medio dei Cluster (Radar)</h2>
                <p class="description">Ogni poligono è un cluster. Più il poligono è esteso su un asse, più quel cluster è attivo in quella feature. Confronta la <span style="color:#e74c3c;font-weight:bold;">forma di C4</span> con gli altri: gli insider hanno un profilo caratteristico diverso dagli utenti normali.</p>
                <div id="radar-cluster" class="chart"></div>
            </section>

            <section class="viz-card">
                <h2>Heatmap Cluster × Feature</h2>
                <p class="description">Ogni cella mostra il valore medio normalizzato di una feature per un cluster. <span style="color:#27ae60;font-weight:bold;">Verde = alto</span>, <span style="color:#e74c3c;font-weight:bold;">rosso = basso</span>. Le colonne con più contrasto tra righe sono le feature più discriminanti. <strong>C4</strong> (bordo rosso) è il cluster degli insider — cerca le celle dove differisce di più dagli altri.</p>
                <div id="heatmap-cluster" class="chart"></div>
            </section>
        </div>
    </main>

    <footer>
        <p>Progetto InfoVis 2024/25 - JS, D3.js, SVG, HTML, CSS</p>
    </footer>

    <!-- carico tutti gli script in ordine (con versione per forzare reload) -->
    <script src="js/config.js?v=8"></script>
    <script src="js/data-loader.js?v=8"></script>
    <script src="js/univariate.js?v=8"></script>
    <script src="js/bivariate.js?v=8"></script>
    <script src="js/trivariate.js?v=8"></script>
    <script src="js/temporal.js?v=8"></script>
    <script src="js/parallel-coordinates.js?v=8"></script>
    <script src="js/multivariate.js?v=8"></script>
    <script src="js/interactions.js?v=8"></script>
    <script src="js/main.js?v=8"></script>
</body>
</html>
